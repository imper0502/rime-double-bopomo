# Rime schema
# encoding: utf-8

schema:
  schema_id: double_bopomo
  name: "é›™ç¢¼æ³¨éŸ³"
  version: "20191031A.9"
  author:
    - imper0502 <yoj845@gmail.com>
  description: |
    ã„§ã„¨ã„©åœ¨ IUYï¼›E ç•¶ã€‡è²æ¯
    -----------------------------------------
    æ³¨éŸ³çš„é›™æ‹¼æ–¹æ¡ˆã€‚
    æœƒæ³¨éŸ³å°±å¯ä»¥å­¸æœƒï¼Œä¸éœ€é¡å¤–å­¸ç¿’æ¼¢èªæ‹¼éŸ³ã€‚
    -----------------------------------------
    layout version: 20191031A
    main version: 0.9

  dependencies:
    - cangjie5

switches:
  - name: ascii_mode
    reset: 0
    states: [ "ä¸­", "En" ]
  - name: full_shape
    reset: 0
    states: [ "åŠå½¢", "å…¨å½¢" ]
  - name: ascii_punct
    reset: 0
    states: [ "ã€‚ï¼Œ", "ï¼ï¼Œ" ]
  - name: t2tw                  # æ­£ç¹è½‰æ›
    reset: 1
#    states: [ "å‚³æ‰¿å­—", "æ¨™æº–å­—" ]
  - name: s2tw                  # ç°¡ç¹è½‰æ›
    reset: 1
    states: [ "ç®€åŒ–å­—", "æ¨™æº–å­—" ]

engine:
  processors:
    - key_binder
    - ascii_composer
    - recognizer
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - affix_segmentor@assistant
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - echo_translator
    - punct_translator
    - script_translator
    - table_translator@assistant
    - table_translator@custom_phrase
  filters:
    - simplifier@t2tw  # æ­£ç¹è½‰æ›
    - simplifier@s2tw  # ç°¡ç¹è½‰æ›
    - cjk_minifier     # éæ¿¾å°‘ç”¨å­—
    - uniquifier       # éæ¿¾é‡è¤‡çš„å€™é¸å­—ï¼Œæœ‰å¯èƒ½ä¾†è‡ªç°¡æ­£ç¹è½‰æ›
    - reverse_lookup_filter@comment_bopomo
    - reverse_lookup_filter@comment_cangjie
    - reverse_lookup_filter@comment_key
    - reverse_lookup_filter@comment_pinyin

t2tw: # æ­£ç¹è½‰æ›
  option_name: t2tw
  opencc_config: t2tw.json
  tips: none

s2tw: # ç°¡ç¹è½‰æ›
  option_name: s2tw
  opencc_config: s2tw.json
  tips: none

menu:
  alternative_select_keys: 67890ABCDE
 
speller:
  alphabet: "bpmfdtnlgkhjqxvwarzcsiuyeo12345'"
  initials: "bpmfdtnlgkhjqxvwarzcsiuyeo"
  finals: "12345'"
  delimiter: " "
  algebra:
  ## (0) ã„…ã„†ã„‡ã„ˆã€€ã„‰ã„Šã„‹ã„Œã€€ã„ã„ã„ã€€ã„ã„‘ã„’ã€€ã„“ã„”ã„•ã„–ã€€ã„—ã„˜å¶ã€€ã„§ã„¨ã„©ï¼‡ã€€ã„§ã„¨ã„©ã€€ã„šã„›ã„œã„ã€€ã„ã„Ÿã„ ã„¡ã€€ã„¢ã„£ã„¤ã„¥ã€€ã„¦
    - erase/^xx$/              #
    - xform/^r5$/er5/          #
  ## (2) #################################
    - xform/^([aoe].*\d)/O$1/  # é›¶è²æ¯Ã˜ã€å½±è²æ¯Ê”
    - xform/eh(?=\d)/Q/        # ã„
    - xform/er(?=\d)/L/        # ã„¦
  ## (5) #################################
    - xform/^zh/Z/             # ã„“
    - xform/^ch/C/             # ã„”
    - xform/^sh/S/             # ã„•
    - xlit/OZCS/EAVO/          #
  ## (9) ##########################################
    - xform/^y(?=[uv]|ong)/Y/  # åˆ†é–‹ã„§ã€ã„©è²æ¯éŸ»
    - xform/^y/I/              # è™•ç†ã„§è²æ¯
    - xform/^w/U/              # è™•ç†ã„¨è²æ¯
  ## (12) ##########################################
    - xform/^([jqxY])[uv]an(?=\d)/$1yan/     # åˆ†é–‹ã„©ã„¢ã€ã„¨ã„¢éŸ»ï¼ˆã„ã„‘ã„’ï¼‰ï¼ˆæ•…æ„å¿½ç•¥ã„Œã„©ã„¢ï¼‰
    - xform/^([nl])v(e|n)(?=\d)/$1y$2/       # è™•ç†ã„©ã„éŸ»ã€åˆ†é–‹ã„©ã„£ã€ã„¨ã„£éŸ»ï¼ˆã„‹ã„Œï¼‰
    - xform/^([jqxY])u(e|n)(?=\d)/$1y$2/     # è™•ç†ã„©ã„éŸ»ã€åˆ†é–‹ã„©ã„£ã€ã„¨ã„£éŸ»ï¼ˆã„ã„‘ã„’ï¼‰
    - xform/^([nljqxY])v(?=\d)/$1y/          # è™•ç†ã„©éŸ»æ¯ï¼ˆã„‹ã„Œï¼‰
    - derive/^([jqxY])u(?=\d)/$1y/           # è™•ç†ã„©éŸ»æ¯ï¼ˆã„ã„‘ã„’ï¼‰
  ## (17) ####################################################
    - xform/[iu]a(?=\d)/X/      #     ï¼›â—Œã„§ã„šï¼›â—Œã„¨ã„šï¼›
    - xform/uo(?=\d)/O/         #     ï¼›      ï¼›â—Œã„¨ã„›ï¼›
    - xform/ie(?=\d)/P/         #     ï¼›â—Œã„§ã„ï¼›      ï¼›
    - xform/ye(?=\d)/Q/         #     ï¼›      ï¼›      ï¼›â—Œã„©ã„
  ## (21) ####################################################
    - xform/iao(?=\d)/N/        #     ï¼›â—Œã„§ã„ ï¼›      ï¼›
    - xform/iu(?=\d)/B/         #     ï¼›â—Œã„§ã„¡ï¼›      ï¼›
    - xform/ian(?=\d)/M/        #     ï¼›â—Œã„§ã„¢ï¼›      ï¼›
    - xform/(in|ui)(?=\d)/V/    #     ï¼›â—Œã„§ã„£ï¼›â—Œã„¨ã„Ÿï¼›
    - xform/[iu]ang(?=\d)/C/    #     ï¼›â—Œã„§ã„¤ï¼›â—Œã„¨ã„¤ï¼›
    - xform/(ing|uai)(?=\d)/G/  #     ï¼›â—Œã„§ã„¥ï¼›â—Œã„¨ã„ï¼›
    - xform/uan(?=\d)/T/        #     ï¼›      ï¼›â—Œã„¨ã„¢ï¼›
    - xform/un(?=\d)/Z/         #     ï¼›      ï¼›â—Œã„¨ã„£ï¼›
    - xform/i?ong(?=\d)/L/      #     ï¼›      ï¼›â—Œã„¨ã„¥ï¼›â—Œã„©ã„¥
  ## (30) ####################################################
    - xform/ai/H/               # â—Œã„
    - xform/ei/W/               # â—Œã„Ÿ
    - xform/ao/S/               # â—Œã„ 
    - xform/ou/R/               # â—Œã„¡
    - xform/y?an(?=\d)/K/       # â—Œã„¢ï¼›      ï¼›      ï¼›â—Œã„©ã„¢
    - xform/[ye]n(?=\d)/D/      # â—Œã„£ï¼›      ï¼›      ï¼›â—Œã„©ã„£
    - xform/ang/J/              # â—Œã„¤
    - xform/eng/F/              # â—Œã„¥
  ## (38)è¡ç”Ÿã„§ã„¨ã„© #########################
    - derive/Ii/ei/             # â—Œã„§
    - derive/Ii/yi/             # â—Œã„§
    - derive/Uu/eu/             # â—Œã„¨
    - derive/Yy/ey/             # â—Œã„©
  ## () ###################################
    - derive/z([a-zA-Z]+)/w$1/  # è¡ç”Ÿã„—
    - derive/EQ(\d)/ew$1/       # è¡ç”Ÿã„
    - derive/EQ(\d)/ep$1/       # è¡ç”Ÿã„
    - derive/IE(\d)/iw$1/       # è¡ç”Ÿã„§ã„
    - derive/IE(\d)/iq$1/       # è¡ç”Ÿã„§ã„
    - derive/YQ(\d)/ye$1/       # è¡ç”Ÿã„©ã„
    - derive/YQ(\d)/yw$1/       # è¡ç”Ÿã„©ã„
    - derive/IV(\d)/id$1/       # è¡ç”Ÿï¼æ”¹å¯«ã„§ã„£
    - derive/IG(\d)/if$1/       # è¡ç”Ÿï¼æ”¹å¯«ã„§ã„¥
    - derive/([jqxY])L(\d)/$1f$2/ # è¡ç”Ÿã„©ã„¥
  ## () ###################################
    - xlit/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/
    - derive/([a-z]{2})\d/$1/
    - abbrev/^([a-z])\w+$/$1'/
    - abbrev/([a-z])[a-z](\d)/$1$2/

translator:
  enable_charset_filter: true
  dictionary: terra_pinyin
  prism: double_bopomo
  preedit_format:
    #### (0) ####
    - xform/([ '])[ ']+/$1/
    - xform/(^|[ '])w/$1z/
    - xform/(^|[ '])e/$1O/
    - xform/(^|[ '])a/$1Z/
    - xform/(^|[ '])v/$1C/
    - xform/(^|[ '])o/$1S/
    - xform/(^|[ '])([ZCSrzcs])i$/$1$2ğŸ˜¬/  ##ã€€è™›éŸ»æ¯ã„­ã†¨ã€‚
    - xform/(^|[ '])([ZCSrzcs])i/$1$2/
    #### (8) ####
    - xform/(O)l/$1R/       # ã„¦*
    - xform/(O)[qp]/$1ã„/   # ã„
    - xform/(i)[weq]/$1ã„/  # ã„§ã„
    - xform/(y)[weq]/$1ã„/  # ã„©ã„
    - xform/(y)[k]/$1ã„¢/    # ã„©ã„¢
    - xform/(y)[d]/$1ã„£/    # ã„©ã„£
    - xform/(y)[fl]/$1ã„¥/   # ã„©ã„¥
    #### (15) ####
    - xform/([nljqx])q/$1ã„©ã„/
    - xform/([jqx])[kt]/$1ã„©ã„¢/
    - xform/([jqx])[dz]/$1ã„©ã„£/
    - xform/([jqx])[fl]/$1ã„©ã„¥/
    #### (19) ####/
    - xform/([gkhZCSr])x/$1ã„¨ã„š/
    - xform/([dtnlgkhZCSrzcs])o/$1ã„¨ã„›/
    - xform/([gkhZCS])g/$1ã„¨ã„/
    - xform/([dtgkhZCSrzcs])v/$1ã„¨ã„Ÿ/
    - xform/([dtnlgkhZCSrzcs])t/$1ã„¨ã„¢/
    - xform/(\w)z/$1ã„¨ã„£/
    - xform/([^nljqx 'zcsrw])c/$1ã„¨ã„¤/
    - xform/(\w)l/$1ã„¨ã„¥/
    #### (27) ####
    - xform/(\w)x/$1ã„§ã„š/
    - xform/(\w)p/$1ã„§ã„/
    - xform/([bpmfdtnljqx])n/$1ã„§ã„ /
    - xform/(\w)b/$1ã„§ã„¡/
    #### (31) ####
    - xform/(\w)m/$1ã„§ã„¢/
    - xform/(\w)v/$1ã„§ã„£/
    - xform/([jqxnl])c/$1ã„§ã„¤/
    - xform/ig/if/
    - xform/(\w)g/$1ã„§ã„¥/
    #### (36) ####
    - xform/(\w)h/$1ã„/  # ã„
    - xform/(\w)w/$1ã„Ÿ/  # ã„Ÿ
    - xform/(\w)s/$1ã„ /  # ã„ 
    - xform/(\w)r/$1ã„¡/  # ã„¡
    #### (40) ####
    - xform/(\w)k/$1ã„¢/  # ã„¢
    - xform/(\w)d/$1ã„£/  # ã„£
    - xform/(\w)j/$1ã„¤/  # ã„¤
    - xform/(\w)f/$1ã„¥/  # ã„¥
    #### (44) ####
    - xform/([jqx])u/$1y/
    - xform/1(?!$)//
    - xform/(..)5(?!$)/5$1/
    - xform/y([iu])$/$1â‡¦/
    - xform/y([iu])/$1/
    - xform/([iuy])\1$/$1â‡¦/
    - xform/([iuy])\1/$1/
    - xform/O([iuyR])$/$1â‡¦/
    #### (52) ####
    - xform/(?<=[bpmfdtnlgkhjqxZCSrzcs][iuy])$/â‡¦/
    - xform/(?<=[bpmfdtnlgkhjqxZCSrzcsiuy])$/â—Œ/
    - xlit/bpmfdtnlgkhjqxZCSrzcsO/ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜å¶â—Œ/
    - xlit/iuyaoeR 12345/ã„§ã„¨ã„©ã„šã„›ã„œã„¦ã€€Ë‰ËŠË‡Ë‹Ë™/
    - xform/(?<![â‡¦â—Œ])$/â‡¦/ #[â‡¦ã€€â—Œâ‡¨]
    - xform/â—Œâ—Œ$/â—Œ/
    - xform/â—Œ(?!$)/$1/

affix_segmentor@assistant:
  extra_tags:
    - reverse_lookup

assistant:
  tag: assistant
  dictionary: cangjie5
  enable_charset_filter: true           # æ˜¯å¦é–‹å•“å­—ç¬¦é›†éæ¿¾ã€”åƒ…table_translatoræœ‰æ•ˆã€‚å•“ç”¨cjk_minifierå¾Œå¯é©ç”¨æ–¼script_translatorã€•
  enable_encoder: false                 # æ˜¯å¦é–‹å•“è‡ªå‹•é€ è©ã€”åƒ…table_translatoræœ‰æ•ˆã€•
  encode_commit_history: false          # æ˜¯å¦å°å·²ä¸Šå±›è©è‡ªå‹•æˆè©ã€”åƒ…table_translatoræœ‰æ•ˆã€•
  max_phrase_length: 1                  # æœ€å¤§è‡ªå‹•æˆè©è©é•·ã€”åƒ…table_translatoræœ‰æ•ˆã€•
  enable_completion: true               # æå‰é¡¯ç¤ºå°šæœªè¼¸å…¥å®Œæ•´ç¢¼çš„å­—ã€”åƒ…table_translatoræœ‰æ•ˆã€•
  sentence_over_completion: false       # åœ¨ç„¡å…¨ç¢¼å°æ‡‰å­—è€Œåƒ…æœ‰é€éµæç¤ºæ™‚ä¹Ÿé–‹å•“æ™ºèƒ½çµ„å¥ã€”åƒ…table_translatoræœ‰æ•ˆã€•
  strict_spelling: false                # é…åˆspellerä¸­çš„fuzzè¦å‰‡ï¼Œåƒ…ä»¥ç•§æ‹¼ç¢¼çµ„è©ã€”åƒ…table_translatoræœ‰æ•ˆã€•
  disable_user_dict_for_patterns: false # ç¦æ­¢æŸäº›ç·¨ç¢¼éŒ„å…¥ç”¨æˆ¶è©å…¸
  enable_sentence:  false               # æ˜¯å¦é–‹å•“è‡ªå‹•é€ å¥
  enable_user_dict: false               # æ˜¯å¦é–‹å•“ç”¨æˆ¶è©å…¸ã€”ç”¨æˆ¶è©å…¸è¨˜éŒ„å‹•æ…‹å­—è©é »ã€ç”¨æˆ¶è©ã€•
  prefix: "`"
  tips: "ã€å€‰é ¡ã€‘"
  suffix: "'"
  closing_tips: "ã€æ³¨éŸ³ã€‘"
  preedit_format:
    - xlit|abcdefghijklmnopqrstuvwxyz|æ—¥æœˆé‡‘æœ¨æ°´ç«åœŸç«¹æˆˆåå¤§ä¸­ä¸€å¼“äººå¿ƒæ‰‹å£å°¸å»¿å±±å¥³ç”°é›£åœç¬¦|
  comment_format:
    - xlit|abcdefghijklmnopqrstuvwxyz|æ—¥æœˆé‡‘æœ¨æ°´ç«åœŸç«¹æˆˆåå¤§ä¸­ä¸€å¼“äººå¿ƒæ‰‹å£å°¸å»¿å±±å¥³ç”°é›£åœç¬¦|

custom_phrase:
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

comment_bopomo:
  tags: [ none ]
  overwrite_comment: true
  dictionary: terra_pinyin
  comment_format:
    - xform/e?r5$/er5/
    - xform/iu/iou/
    - xform/ui/uei/
    - xform/ong/ung/
    - xform/(^|[ ])yi?/$1i/
    - xform/(^|[ ])wu?/$1u/
    - xform/iu/v/
    - xform/(^|[ ])([jqx])u/$1$2v/
    - xform/([iuv])n/$1en/
    - xform/zh/Z/
    - xform/ch/C/
    - xform/sh/S/
    - xform/ai/A/
    - xform/ei/I/
    - xform/ao/O/
    - xform/ou/U/
    - xform/ang/K/
    - xform/eng/G/
    - xform/an/M/
    - xform/en/N/
    - xform/er/R/
    - xform/eh/E/
    - xform/([iv])e/$1E/
    - xform/1//
    - xform/([a-zA-Z]+)5/5$1/
    - xform/([a-zA-Z1-5]+)($|[ ])/ã€”$1ã€•/
    - xform/([ZCSr])i(\d*)/$1$2/
    - xform/([zcs])i(\d*)/$1$2/
    - xlit/bpmfdtnlgkhjqxZCSrzcsiuvaoeEAIOUMNKGR2345/ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦ËŠË‡Ë‹Ë™/
    # â†—âœ”â†˜â’ºâ“”â‹â‹ï¼ğŸ˜¬ğŸˆ³

comment_cangjie:
  tags: [ none ]
  overwrite_comment: false
  dictionary: cangjie5
  comment_format:
    - xform/([^ ]+)($|[ ])/ã€”$1ã€•/
    - xlit|abcdefghijklmnopqrstuvwxyz|æ—¥æœˆé‡‘æœ¨æ°´ç«åœŸç«¹æˆˆåå¤§ä¸­ä¸€å¼“äººå¿ƒæ‰‹å£å°¸å»¿å±±å¥³ç”°é›£åœç¬¦|

comment_key:
  tags: [ none ]
  overwrite_comment: false
  dictionary: luna_pinyin
  comment_format:
    ####################################  æ–½å·¥ä¸­  ############################################
    - erase/^xx(?:$| )/
    - xform/([a-zA-Z]*)[1-5]/$1/
    ##
    - xlit/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/
    - xlit/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/
    - xform/([a-z]+)($|[ ])/ã€$1ã€‘/

comment_pinyin:
  tags: [ none ]
  overwrite_comment: false
  dictionary: terra_pinyin
  comment_format:
    - xform ([aeiou])(ng?|r)([1234]) $1$3$2
    - xform ([aeo])([iuo])([1234]) $1$3$2
    - xform a1 Ä
    - xform a2 Ã¡
    - xform a3 Ç
    - xform a4 Ã 
    - xform e1 Ä“
    - xform e2 Ã©
    - xform e3 Ä›
    - xform e4 Ã¨
    - xform o1 Å
    - xform o2 Ã³
    - xform o3 Ç’
    - xform o4 Ã²
    - xform i1 Ä«
    - xform i2 Ã­
    - xform i3 Ç
    - xform i4 Ã¬
    - xform u1 Å«
    - xform u2 Ãº
    - xform u3 Ç”
    - xform u4 Ã¹
    - xform v1 Ç–
    - xform v2 Ç˜
    - xform v3 Çš
    - xform v4 Çœ
    - xform/([nljqxy])v/$1Ã¼/
    - xform/eh[0-5]?/Ãª/
    - xform/([a-z]+)[0-5]/$1/
    - xform/(.+)($|[ ])/ã€”$1ã€•/

punctuator:
  import_preset: symbols
  full_shape:
    '<' : '<'
    '>' : '>'
    '$' : [ 'NT$', '$', 'â‚¬', 'Â£', 'Â¥', 'Â¢', 'Â¤', 'ï¿¥' ]
  half_shape:
    '<' : '<'
    '>' : '>'
    '$' : [ 'NT$', '$', 'â‚¬', 'Â£', 'Â¥', 'Â¢', 'Â¤', 'ï¿¥' ]

key_binder:
  import_preset: default

recognizer:
  import_preset: default
  patterns:
    assistant: "`[a-z]*'?$"
    punct: "^/([0-9]0?|[A-Za-z]+)$"
    url: "^(www[.]|https?:|ftp:|mailto:).*$"
